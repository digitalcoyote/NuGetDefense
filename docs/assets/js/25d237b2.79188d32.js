"use strict";(self.webpackChunknugetdefense_docs=self.webpackChunknugetdefense_docs||[]).push([[360],{1452:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>r,default:()=>o,frontMatter:()=>t,metadata:()=>c,toc:()=>d});var a=i(7624),s=i(4552);const t={title:"NuGetDefense.Lib"},r="Summary",c={id:"API Reference/NuGetDefense.Lib",title:"NuGetDefense.Lib",description:"NuGetDefense.Lib provides programmatic access to all the features of NuGetDefense. The main use is in the Scanner.Scan method which returns the number of vulnerabilities found.",source:"@site/docs/API Reference/NuGetDefense.Lib.md",sourceDirName:"API Reference",slug:"/API Reference/NuGetDefense.Lib",permalink:"/NuGetDefense/docs/API Reference/NuGetDefense.Lib",draft:!1,unlisted:!1,editUrl:"https://github.com/digitalcoyote/NuGetDefenseDocs/tree/master/docs/API Reference/NuGetDefense.Lib.md",tags:[],version:"current",frontMatter:{title:"NuGetDefense.Lib"},sidebar:"tutorialSidebar",previous:{title:"CLI Reference",permalink:"/NuGetDefense/docs/cli-reference"},next:{title:"NuGetDefense.NVD",permalink:"/NuGetDefense/docs/API Reference/NuGetDefense.NVD"}},l={},d=[{value:"Scanner",id:"scanner",level:2},{value:"Scan(Scanoptions)",id:"scanscanoptions",level:3},{value:"GetNonSensitivePackages(out Dictionary'<string, NuGetPackage[]>')",id:"getnonsensitivepackagesout-dictionarystring-nugetpackage",level:3},{value:"ScanOptions",id:"scanoptions",level:2},{value:"Cache",id:"cache",level:3},{value:"CheckReferencedProjects",id:"checkreferencedprojects",level:3},{value:"CheckTransitiveDependencies",id:"checktransitivedependencies",level:3},{value:"IgnoreCves",id:"ignorecves",level:3},{value:"IgnorePackages",id:"ignorepackages",level:3},{value:"ProjectFile",id:"projectfile",level:3},{value:"SettingsFile",id:"settingsfile",level:3},{value:"Tfm",id:"tfm",level:3},{value:"VulnDataFile",id:"vulndatafile",level:3},{value:"WarnOnly",id:"warnonly",level:3},{value:"NuGetPackage",id:"nugetpackage",level:2},{value:"Dependencies",id:"dependencies",level:3},{value:"Id",id:"id",level:3},{value:"Version",id:"version",level:3},{value:"PackageUrl",id:"packageurl",level:3},{value:"VulnerabilityCache",id:"vulnerabilitycache",level:2},{value:"GetUncachedPackagesFunc",id:"getuncachedpackagesfunc",level:3},{value:"GetPackageCachedVulnerabilitiesForSource",id:"getpackagecachedvulnerabilitiesforsource",level:3},{value:"UpdateCache",id:"updatecache",level:3},{value:"GetSqliteCache",id:"getsqlitecache",level:3},{value:"VulnerabilityReport",id:"vulnerabilityreport",level:2},{value:"VulnerabilitiesCount",id:"vulnerabilitiescount",level:3},{value:"Packages",id:"packages",level:3},{value:"VulnerableNuGetPackage",id:"vulnerablenugetpackage",level:2},{value:"Id",id:"id-1",level:3},{value:"PackageUrl",id:"packageurl-1",level:3},{value:"Version",id:"version-1",level:3},{value:"Vulnerabilities",id:"vulnerabilities",level:3},{value:"ReportedVulnerability",id:"reportedvulnerability",level:2},{value:"Description",id:"description",level:3},{value:"Cve",id:"cve",level:3},{value:"Cwe",id:"cwe",level:3},{value:"CvssScore",id:"cvssscore",level:3},{value:"CvssVector",id:"cvssvector",level:3}];function h(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",p:"p",...(0,s.M)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.h1,{id:"summary",children:"Summary"}),"\n",(0,a.jsx)(n.p,{children:"NuGetDefense.Lib provides programmatic access to all the features of NuGetDefense. The main use is in the Scanner.Scan method which returns the number of vulnerabilities found."}),"\n",(0,a.jsx)(n.h2,{id:"scanner",children:"Scanner"}),"\n",(0,a.jsx)(n.h3,{id:"scanscanoptions",children:"Scan(Scanoptions)"}),"\n",(0,a.jsx)(n.p,{children:"Scan is the main method and performs the same scan as NuGetDefense"}),"\n",(0,a.jsxs)(n.h3,{id:"getnonsensitivepackagesout-dictionarystring-nugetpackage",children:["GetNonSensitivePackages(out Dictionary","<string, NuGetPackage[]>",")"]}),"\n",(0,a.jsxs)(n.p,{children:["Reads SensitivePackages in Settings and escapes all characters for Regex, then replaces ",(0,a.jsx)(n.code,{children:"*"})," with ",(0,a.jsx)(n.code,{children:".*"})," (Regex wild Card for 0 or more of any character). Then returns a list of packages that do not match the wild card strings in SensitivePackages."]}),"\n",(0,a.jsx)(n.h2,{id:"scanoptions",children:"ScanOptions"}),"\n",(0,a.jsx)(n.h3,{id:"cache",children:"Cache"}),"\n",(0,a.jsxs)(n.p,{children:["Currently, this only accepts a SqlLiteVulnerabilityCache (with ",(0,a.jsx)(n.code,{children:"Path"})," and ",(0,a.jsx)(n.code,{children:"Enabled"}),") fields. Future versions will include a Type field to support non-local caches."]}),"\n",(0,a.jsx)(n.h3,{id:"checkreferencedprojects",children:"CheckReferencedProjects"}),"\n",(0,a.jsx)(n.p,{children:"Boolean used to determine if project referenced are scanned"}),"\n",(0,a.jsx)(n.h3,{id:"checktransitivedependencies",children:"CheckTransitiveDependencies"}),"\n",(0,a.jsx)(n.p,{children:"Boolean used to determine if nuget should be used to resolve transitive dependencies"}),"\n",(0,a.jsx)(n.h3,{id:"ignorecves",children:"IgnoreCves"}),"\n",(0,a.jsx)(n.p,{children:"Ignores specific vulnerabilities found in this set when reporting them. CVEs are generally the ID for vulnerabilities, but any ID returned by NuGetDefense will work here."}),"\n",(0,a.jsx)(n.h3,{id:"ignorepackages",children:"IgnorePackages"}),"\n",(0,a.jsx)(n.p,{children:"Ignores specific package id's to ignore."}),"\n",(0,a.jsx)(n.h3,{id:"projectfile",children:"ProjectFile"}),"\n",(0,a.jsx)(n.p,{children:"File used to obtain dependency info."}),"\n",(0,a.jsx)(n.h3,{id:"settingsfile",children:"SettingsFile"}),"\n",(0,a.jsx)(n.p,{children:"Allows loading a NuGetDefense config file"}),"\n",(0,a.jsx)(n.h3,{id:"tfm",children:"Tfm"}),"\n",(0,a.jsxs)(n.p,{children:["The ",(0,a.jsx)(n.a,{href:"https://docs.microsoft.com/en-us/dotnet/standard/frameworks#supported-target-frameworks",children:"TFM or Target Framework Moniker"})," provided to nuget when getting transitive dependencies."]}),"\n",(0,a.jsx)(n.h3,{id:"vulndatafile",children:"VulnDataFile"}),"\n",(0,a.jsx)(n.p,{children:"The File used to store/retrieve NVD Data"}),"\n",(0,a.jsx)(n.h3,{id:"warnonly",children:"WarnOnly"}),"\n",(0,a.jsx)(n.p,{children:"If True, only emits warnings"}),"\n",(0,a.jsx)(n.h2,{id:"nugetpackage",children:"NuGetPackage"}),"\n",(0,a.jsx)(n.h3,{id:"dependencies",children:"Dependencies"}),"\n",(0,a.jsx)(n.p,{children:"Array of strings that represent the dependencies of this package"}),"\n",(0,a.jsx)(n.h3,{id:"id",children:"Id"}),"\n",(0,a.jsx)(n.p,{children:"This is the Id defined in the nuspec file and used in package references and the package.json"}),"\n",(0,a.jsx)(n.h3,{id:"version",children:"Version"}),"\n",(0,a.jsx)(n.p,{children:"Package version"}),"\n",(0,a.jsx)(n.h3,{id:"packageurl",children:"PackageUrl"}),"\n",(0,a.jsxs)(n.p,{children:["The ",(0,a.jsx)(n.a,{href:"https://github.com/package-url/purl-spec",children:"package url spec"})," is a representation of the package ecosystem, ID, and string used to disambiguate this package from similarly named packages in other ecosystems"]}),"\n",(0,a.jsx)(n.h2,{id:"vulnerabilitycache",children:"VulnerabilityCache"}),"\n",(0,a.jsx)(n.p,{children:"The workhorse of the cache."}),"\n",(0,a.jsx)(n.h3,{id:"getuncachedpackagesfunc",children:"GetUncachedPackagesFunc"}),"\n",(0,a.jsx)(n.p,{children:"Once set, this function spits out an array of packages that need to be checked."}),"\n",(0,a.jsx)(n.h3,{id:"getpackagecachedvulnerabilitiesforsource",children:"GetPackageCachedVulnerabilitiesForSource"}),"\n",(0,a.jsx)(n.p,{children:"Once set this function returns an array of cached vulnerabilities"}),"\n",(0,a.jsx)(n.h3,{id:"updatecache",children:"UpdateCache"}),"\n",(0,a.jsx)(n.p,{children:"Once set this function updates the cache with the results of a scan"}),"\n",(0,a.jsx)(n.h3,{id:"getsqlitecache",children:"GetSqliteCache"}),"\n",(0,a.jsx)(n.p,{children:"This is a static method that creates a new sqlite cache"}),"\n",(0,a.jsx)(n.h2,{id:"vulnerabilityreport",children:"VulnerabilityReport"}),"\n",(0,a.jsx)(n.p,{children:"Reporting object used to gather data for reporting."}),"\n",(0,a.jsx)(n.h3,{id:"vulnerabilitiescount",children:"VulnerabilitiesCount"}),"\n",(0,a.jsx)(n.p,{children:"Number of vulnerabilities reported"}),"\n",(0,a.jsx)(n.h3,{id:"packages",children:"Packages"}),"\n",(0,a.jsx)(n.p,{children:"Array of VulnerableNuGetPackage containing vulnerable packages and vulnerability details"}),"\n",(0,a.jsx)(n.h2,{id:"vulnerablenugetpackage",children:"VulnerableNuGetPackage"}),"\n",(0,a.jsx)(n.h3,{id:"id-1",children:"Id"}),"\n",(0,a.jsx)(n.p,{children:"ID of the vulnerable nuget package"}),"\n",(0,a.jsx)(n.h3,{id:"packageurl-1",children:"PackageUrl"}),"\n",(0,a.jsxs)(n.p,{children:["The ",(0,a.jsx)(n.a,{href:"https://github.com/package-url/purl-spec",children:"package url spec"})," is a representation of the package ecosystem, ID, and string used to disambiguate this package from similarly named packages in other ecosystems"]}),"\n",(0,a.jsx)(n.h3,{id:"version-1",children:"Version"}),"\n",(0,a.jsx)(n.p,{children:"Version of the vulnerable package"}),"\n",(0,a.jsx)(n.h3,{id:"vulnerabilities",children:"Vulnerabilities"}),"\n",(0,a.jsx)(n.p,{children:"Array of ReportedVulnerability. Contains data about reported vulberabilities for this package"}),"\n",(0,a.jsx)(n.h2,{id:"reportedvulnerability",children:"ReportedVulnerability"}),"\n",(0,a.jsx)(n.h3,{id:"description",children:"Description"}),"\n",(0,a.jsx)(n.p,{children:"Description of the vulnerability. Usually enough to assess the risk."}),"\n",(0,a.jsx)(n.h3,{id:"cve",children:"Cve"}),"\n",(0,a.jsx)(n.p,{children:"ID of the vulnerability"}),"\n",(0,a.jsx)(n.h3,{id:"cwe",children:"Cwe"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.a,{href:"https://cwe.mitre.org/index.html",children:"Common Weakness Enumeration"})}),"\n",(0,a.jsx)(n.h3,{id:"cvssscore",children:"CvssScore"}),"\n",(0,a.jsx)(n.p,{children:"Severity score. Generally the higher the number the worse."}),"\n",(0,a.jsx)(n.h3,{id:"cvssvector",children:"CvssVector"}),"\n",(0,a.jsx)(n.p,{children:"Access Vector of the vulnerability."})]})}function o(e={}){const{wrapper:n}={...(0,s.M)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(h,{...e})}):h(e)}},4552:(e,n,i)=>{i.d(n,{M:()=>r});var a=i(1504);const s={},t=a.createContext(s);function r(e){const n=a.useContext(t);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}}}]);